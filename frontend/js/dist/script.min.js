"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}var DocumentQA=function(){function e(){_classCallCheck(this,e),this.form=document.getElementById("qaForm"),this.fileInput=document.getElementById("documentFile"),this.fileUploadArea=document.getElementById("fileUploadArea"),this.browseBtn=document.getElementById("browseBtn"),this.fileInfo=document.getElementById("fileInfo"),this.fileName=document.getElementById("fileName"),this.removeFileBtn=document.getElementById("removeFile"),this.resultsContainer=document.getElementById("results"),this.answersList=document.getElementById("answersList"),this.errorContainer=document.getElementById("error"),this.errorMessage=document.getElementById("errorMessage"),this.submitBtn=document.getElementById("submitBtn"),this.btnText=this.submitBtn.querySelector(".btn-text"),this.btnLoading=this.submitBtn.querySelector(".btn-loading"),this.selectedFile=null,this.backendUrl="http://localhost:10000",this.initEventListeners()}return _createClass(e,[{key:"initEventListeners",value:function(){var t=this;this.form.addEventListener("submit",function(e){return t.handleSubmit(e)}),this.browseBtn.addEventListener("click",function(){return t.fileInput.click()}),this.fileInput.addEventListener("change",function(e){return t.handleFileSelect(e)}),this.removeFileBtn.addEventListener("click",function(){return t.removeFile()}),this.fileUploadArea.addEventListener("dragover",function(e){return t.handleDragOver(e)}),this.fileUploadArea.addEventListener("dragleave",function(e){return t.handleDragLeave(e)}),this.fileUploadArea.addEventListener("drop",function(e){return t.handleDrop(e)})}},{key:"handleDragOver",value:function(e){e.preventDefault(),this.fileUploadArea.classList.add("drag-over")}},{key:"handleDragLeave",value:function(e){e.preventDefault(),this.fileUploadArea.classList.remove("drag-over")}},{key:"handleDrop",value:function(e){e.preventDefault(),this.fileUploadArea.classList.remove("drag-over");var t=e.dataTransfer.files;0<t.length&&this.processFile(t[0])}},{key:"handleFileSelect",value:function(e){var t=e.target.files;0<t.length&&this.processFile(t[0])}},{key:"processFile",value:function(e){if("application/pdf"===e.type){10485760<e.size?this.displayError("File size must be less than 10MB"):(this.selectedFile=e,this.displayFileInfo(e),this.hideError())}else this.displayError("Please select a PDF file")}},{key:"displayFileInfo",value:function(e){var t=this.formatFileSize(e.size);this.fileName.innerHTML="".concat(e.name,' <span class="file-size">(').concat(t,")</span>"),this.fileInfo.style.display="flex"}},{key:"formatFileSize",value:function(e){if(0===e)return"0 Bytes";var t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]}},{key:"removeFile",value:function(){this.selectedFile=null,this.fileInput.value="",this.fileInfo.style.display="none"}},{key:"handleSubmit",value:function(t){var n,r;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),n=document.getElementById("questions").value,this.validateInputs(n)){e.next=4;break}return e.abrupt("return");case 4:return this.showLoading(),this.hideResults(),this.hideError(),e.prev=7,e.next=10,regeneratorRuntime.awrap(this.callBackendAPI(n));case 10:r=e.sent,this.displayResults(r),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(7),console.error("Error:",e.t0),this.displayError(e.t0.message);case 18:return e.prev=18,this.hideLoading(),e.finish(18);case 21:case"end":return e.stop()}},null,this,[[7,14,18,21]])}},{key:"callBackendAPI",value:function(t){var n,r,s,i,a;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.split("\n").map(function(e){return e.trim()}).filter(function(e){return 0<e.length}),(r=new FormData).append("file",this.selectedFile),r.append("questions",JSON.stringify(n)),e.next=6,regeneratorRuntime.awrap(fetch("".concat(this.backendUrl,"/api/v1/hackrx/upload"),{method:"POST",body:r}));case 6:if((s=e.sent).ok){e.next=12;break}return e.next=10,regeneratorRuntime.awrap(s.text());case 10:throw i=e.sent,new Error("Server error (".concat(s.status,"): ").concat(i));case 12:return e.next=14,regeneratorRuntime.awrap(s.json());case 14:if((a=e.sent).error)throw new Error(a.error);e.next=17;break;case 17:return e.abrupt("return",a);case 18:case"end":return e.stop()}},null,this)}},{key:"validateInputs",value:function(e){this.hideError();var t=[];return this.selectedFile||t.push("Please select a PDF file"),e||t.push("Please enter at least one question"),!(0<t.length)||(this.displayError(t.join("<br>")),!1)}},{key:"showLoading",value:function(){this.submitBtn.disabled=!0,this.btnText.style.display="none",this.btnLoading.style.display="inline-block"}},{key:"hideLoading",value:function(){this.submitBtn.disabled=!1,this.btnText.style.display="inline-block",this.btnLoading.style.display="none"}},{key:"displayResults",value:function(e){var r=this;(this.answersList.innerHTML="",e.answers&&0<e.answers.length)?(this.resultsContainer.querySelector("h2").innerHTML='ðŸ“‹ Answers <span class="answer-count">'.concat(e.answers.length," results</span>"),e.answers.forEach(function(e,t){var n=r.createAnswerElement(e,t);r.answersList.appendChild(n)}),this.showResults()):this.displayError("No answers received from the server")}},{key:"createAnswerElement",value:function(e,t){var n=document.createElement("div");n.className="answer-item";var r=e.question||"Question ".concat(t+1),s=e.answer||"No answer provided";return n.innerHTML="\n            <h3>".concat(this.escapeHtml(r),"</h3>\n            <p>").concat(this.formatAnswer(s),"</p>\n        "),n}},{key:"formatAnswer",value:function(e){return this.escapeHtml(e).replace(/\n/g,"<br>")}},{key:"escapeHtml",value:function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}},{key:"showResults",value:function(){this.resultsContainer.style.display="block",this.resultsContainer.scrollIntoView({behavior:"smooth"})}},{key:"hideResults",value:function(){this.resultsContainer.style.display="none"}},{key:"displayError",value:function(e){this.errorMessage.innerHTML=e,this.errorContainer.style.display="block",this.errorContainer.scrollIntoView({behavior:"smooth"})}},{key:"hideError",value:function(){this.errorContainer.style.display="none"}}]),e}();document.addEventListener("DOMContentLoaded",function(){new DocumentQA;var e=document.getElementById("questions");e.value||(e.value="What is the main purpose of this document?\nWhat are the key terms and conditions?\nHow does the process work?\nWhat are the important clauses?")});
//# sourceMappingURL=script.min.js.map
