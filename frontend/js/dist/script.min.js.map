{"version":3,"sources":["script.js"],"names":["DocumentQA","_classCallCheck","this","form","document","getElementById","fileInput","fileUploadArea","browseBtn","fileInfo","fileName","resultsContainer","answersList","errorContainer","errorMessage","submitBtn","btnText","removeFileBtn","_this","addEventListener","e","handleSubmit","selectedFile","click","backendUrl","handleFileSelect","removeFile","handleDragOver","handleDragLeave","handleDrop","preventDefault","add","remove","files","dataTransfer","length","target","processFile","file","displayError","classList","fileSize","formatFileSize","size","innerHTML","concat","name","style","display","bytes","i","Math","floor","log","parseFloat","pow","toFixed","value","questions","validateInputs","displayFileInfo","hideError","callBackendAPI","response","console","error","_context","t0","message","hideLoading","map","q","trim","filter","FormData","formData","JSON","stringify","questionList","fetch","method","body","ok","text","errorText","Error","status","json","data","showLoading","errors","push","join","disabled","btnLoading","_this2","answers","querySelector","item","index","answerElement","createAnswerElement","appendChild","div","createElement","question","answer","escapeHtml","formatAnswer","replace","unsafe","scrollIntoView","behavior","sampleQuestions"],"mappings":"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","file":"script.min.js","sourcesContent":["class DocumentQA {\r\n    constructor() {\r\n        this.form = document.getElementById('qaForm');\r\n        this.fileInput = document.getElementById('documentFile');\r\n        this.fileUploadArea = document.getElementById('fileUploadArea');\r\n        this.browseBtn = document.getElementById('browseBtn');\r\n        this.fileInfo = document.getElementById('fileInfo');\r\n        this.fileName = document.getElementById('fileName');\r\n        this.removeFileBtn = document.getElementById('removeFile');\r\n        this.resultsContainer = document.getElementById('results');\r\n        this.answersList = document.getElementById('answersList');\r\n        this.errorContainer = document.getElementById('error');\r\n        this.errorMessage = document.getElementById('errorMessage');\r\n        this.submitBtn = document.getElementById('submitBtn');\r\n        this.btnText = this.submitBtn.querySelector('.btn-text');\r\n        this.btnLoading = this.submitBtn.querySelector('.btn-loading');\r\n        \r\n        this.selectedFile = null;\r\n        this.backendUrl = 'http://localhost:10000'; // Fixed backend URL\r\n        \r\n        this.initEventListeners();\r\n    }\r\n    \r\n    initEventListeners() {\r\n        // Form submission\r\n        this.form.addEventListener('submit', (e) => this.handleSubmit(e));\r\n        \r\n        // File upload events\r\n        this.browseBtn.addEventListener('click', () => this.fileInput.click());\r\n        this.fileInput.addEventListener('change', (e) => this.handleFileSelect(e));\r\n        this.removeFileBtn.addEventListener('click', () => this.removeFile());\r\n        \r\n        // Drag and drop events\r\n        this.fileUploadArea.addEventListener('dragover', (e) => this.handleDragOver(e));\r\n        this.fileUploadArea.addEventListener('dragleave', (e) => this.handleDragLeave(e));\r\n        this.fileUploadArea.addEventListener('drop', (e) => this.handleDrop(e));\r\n    }\r\n    \r\n    handleDragOver(e) {\r\n        e.preventDefault();\r\n        this.fileUploadArea.classList.add('drag-over');\r\n    }\r\n    \r\n    handleDragLeave(e) {\r\n        e.preventDefault();\r\n        this.fileUploadArea.classList.remove('drag-over');\r\n    }\r\n    \r\n    handleDrop(e) {\r\n        e.preventDefault();\r\n        this.fileUploadArea.classList.remove('drag-over');\r\n        \r\n        const files = e.dataTransfer.files;\r\n        if (files.length > 0) {\r\n            this.processFile(files[0]);\r\n        }\r\n    }\r\n    \r\n    handleFileSelect(e) {\r\n        const files = e.target.files;\r\n        if (files.length > 0) {\r\n            this.processFile(files[0]);\r\n        }\r\n    }\r\n    \r\n    processFile(file) {\r\n        // Validate file type\r\n        if (file.type !== 'application/pdf') {\r\n            this.displayError('Please select a PDF file');\r\n            return;\r\n        }\r\n        \r\n        // Validate file size (10MB limit)\r\n        const maxSize = 10 * 1024 * 1024; // 10MB in bytes\r\n        if (file.size > maxSize) {\r\n            this.displayError('File size must be less than 10MB');\r\n            return;\r\n        }\r\n        \r\n        this.selectedFile = file;\r\n        this.displayFileInfo(file);\r\n        this.hideError();\r\n    }\r\n    \r\n    displayFileInfo(file) {\r\n        const fileSize = this.formatFileSize(file.size);\r\n        this.fileName.innerHTML = `${file.name} <span class=\"file-size\">(${fileSize})</span>`;\r\n        this.fileInfo.style.display = 'flex';\r\n    }\r\n    \r\n    formatFileSize(bytes) {\r\n        if (bytes === 0) return '0 Bytes';\r\n        const k = 1024;\r\n        const sizes = ['Bytes', 'KB', 'MB', 'GB'];\r\n        const i = Math.floor(Math.log(bytes) / Math.log(k));\r\n        return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\r\n    }\r\n    \r\n    removeFile() {\r\n        this.selectedFile = null;\r\n        this.fileInput.value = '';\r\n        this.fileInfo.style.display = 'none';\r\n    }\r\n    \r\n    async handleSubmit(e) {\r\n        e.preventDefault();\r\n        \r\n        const questions = document.getElementById('questions').value;\r\n        \r\n        // Validate inputs\r\n        if (!this.validateInputs(questions)) {\r\n            return;\r\n        }\r\n        \r\n        this.showLoading();\r\n        this.hideResults();\r\n        this.hideError();\r\n        \r\n        try {\r\n            const response = await this.callBackendAPI(questions);\r\n            this.displayResults(response);\r\n            \r\n        } catch (error) {\r\n            console.error('Error:', error);\r\n            this.displayError(error.message);\r\n        } finally {\r\n            this.hideLoading();\r\n        }\r\n    }\r\n    \r\n    async callBackendAPI(questions) {\r\n        const questionList = questions.split('\\n')\r\n            .map(q => q.trim())\r\n            .filter(q => q.length > 0);\r\n        \r\n        // Create FormData for file upload\r\n        const formData = new FormData();\r\n        formData.append('file', this.selectedFile);\r\n        formData.append('questions', JSON.stringify(questionList));\r\n        \r\n        const response = await fetch(`${this.backendUrl}/api/v1/hackrx/upload`, {\r\n            method: 'POST',\r\n            body: formData\r\n        });\r\n        \r\n        if (!response.ok) {\r\n            const errorText = await response.text();\r\n            throw new Error(`Server error (${response.status}): ${errorText}`);\r\n        }\r\n        \r\n        const data = await response.json();\r\n        \r\n        if (data.error) {\r\n            throw new Error(data.error);\r\n        }\r\n        \r\n        return data;\r\n    }\r\n    \r\n    validateInputs(questions) {\r\n        // Clear previous errors\r\n        this.hideError();\r\n        \r\n        const errors = [];\r\n        \r\n        if (!this.selectedFile) {\r\n            errors.push('Please select a PDF file');\r\n        }\r\n        \r\n        if (!questions) {\r\n            errors.push('Please enter at least one question');\r\n        }\r\n        \r\n        if (errors.length > 0) {\r\n            this.displayError(errors.join('<br>'));\r\n            return false;\r\n        }\r\n        \r\n        return true;\r\n    }\r\n    \r\n    showLoading() {\r\n        this.submitBtn.disabled = true;\r\n        this.btnText.style.display = 'none';\r\n        this.btnLoading.style.display = 'inline-block';\r\n    }\r\n    \r\n    hideLoading() {\r\n        this.submitBtn.disabled = false;\r\n        this.btnText.style.display = 'inline-block';\r\n        this.btnLoading.style.display = 'none';\r\n    }\r\n    \r\n    displayResults(data) {\r\n        this.answersList.innerHTML = '';\r\n        \r\n        if (data.answers && data.answers.length > 0) {\r\n            // Add answer count to title\r\n            const title = this.resultsContainer.querySelector('h2');\r\n            title.innerHTML = `ðŸ“‹ Answers <span class=\"answer-count\">${data.answers.length} results</span>`;\r\n            \r\n            data.answers.forEach((item, index) => {\r\n                const answerElement = this.createAnswerElement(item, index);\r\n                this.answersList.appendChild(answerElement);\r\n            });\r\n            \r\n            this.showResults();\r\n        } else {\r\n            this.displayError('No answers received from the server');\r\n        }\r\n    }\r\n    \r\n    createAnswerElement(item, index) {\r\n        const div = document.createElement('div');\r\n        div.className = 'answer-item';\r\n        \r\n        const question = item.question || `Question ${index + 1}`;\r\n        const answer = item.answer || 'No answer provided';\r\n        \r\n        div.innerHTML = `\r\n            <h3>${this.escapeHtml(question)}</h3>\r\n            <p>${this.formatAnswer(answer)}</p>\r\n        `;\r\n        \r\n        return div;\r\n    }\r\n    \r\n    formatAnswer(answer) {\r\n        // Convert line breaks and preserve formatting\r\n        return this.escapeHtml(answer).replace(/\\n/g, '<br>');\r\n    }\r\n    \r\n    escapeHtml(unsafe) {\r\n        return unsafe\r\n            .replace(/&/g, \"&amp;\")\r\n            .replace(/</g, \"&lt;\")\r\n            .replace(/>/g, \"&gt;\")\r\n            .replace(/\"/g, \"&quot;\")\r\n            .replace(/'/g, \"&#039;\");\r\n    }\r\n    \r\n    showResults() {\r\n        this.resultsContainer.style.display = 'block';\r\n        this.resultsContainer.scrollIntoView({ behavior: 'smooth' });\r\n    }\r\n    \r\n    hideResults() {\r\n        this.resultsContainer.style.display = 'none';\r\n    }\r\n    \r\n    displayError(message) {\r\n        this.errorMessage.innerHTML = message;\r\n        this.errorContainer.style.display = 'block';\r\n        this.errorContainer.scrollIntoView({ behavior: 'smooth' });\r\n    }\r\n    \r\n    hideError() {\r\n        this.errorContainer.style.display = 'none';\r\n    }\r\n}\r\n\r\n// Initialize the application when DOM is loaded\r\ndocument.addEventListener('DOMContentLoaded', () => {\r\n    new DocumentQA();\r\n    \r\n    // Add some sample data for testing\r\n    const sampleQuestions = document.getElementById('questions');\r\n    if (!sampleQuestions.value) {\r\n        sampleQuestions.value = `What is the main purpose of this document?\r\nWhat are the key terms and conditions?\r\nHow does the process work?\r\nWhat are the important clauses?`;\r\n    }\r\n});"]}